// The codes are from Armen Aghajanyan from f